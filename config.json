{
  "__comments": {
    "_": "Комментарии и варианты параметров (ключ __comments не используется программой).",
    "input_dir": "Папка с входными JSON-файлами. Варианты: любая папка относительно корня проекта, например 'IN', 'input', 'data/json'.",
    "output_dir": "Папка для CSV и XLSX. Варианты: 'OUT', 'output', 'export', 'result'.",
    "input_files": "Список имён файлов (без пути) из input_dir. Варианты: один файл ['file.json'], несколько ['a.json','b.json'], массив из одного элемента для одного файла.",
    "path_separator": "Разделитель между ключами в имени колонки. Варианты: ' - ' (по умолчанию), '|', '.', '__', '/'.",
    "path_start": "Цепочка ключей, с которой начинать разбор (имена колонок и данные без префикса). Варианты: [] — от корня; ['data','body'] — колонки без 'data - body -'; ['results','item'] — для вложенных массивов.",
    "exclude_keys": "Ключи или полные пути, не попадающие в выход. Варианты: по имени ключа ['photoData']; по пути ['colorCode - secondary']; несколько ['key1','key2'].",
    "include_only_keys": "Если не пусто — в выход только эти колонки. Варианты: [] — все колонки (с учётом exclude_keys); ['firstName','lastName','employeeNumber'] — только перечисленные (имена после path_start).",
    "csv_encoding": "Кодировка CSV. Варианты: 'utf-8-sig' (с BOM для Excel), 'utf-8', 'cp1251', 'latin-1'.",
    "csv_delimiter": "Разделитель полей в CSV. Варианты: ';' (удобно для Excel в регионах с запятой в числах), ',', '\\t'.",
    "csv_lineterminator": "Окончание строки. Варианты: '\\n' (Unix), '\\r\\n' (Windows).",
    "xlsx_freeze_first_row": "Заморозить первую строку (заголовки). true | false. Учитывается, если не задан freeze_cell.",
    "xlsx_freeze_cell": "Ячейка-граница закрепления по умолчанию для всех листов. Варианты: 'A2' — закрепить первую строку; 'B1' — первую колонку; 'B2' — строку и колонку; пусто — использовать freeze_first_row (при true = A2).",
    "xlsx_column_width_mode": "Режим ширины колонок: auto — автоподбор в пределах width_min..width_max; minimum — всегда width_min; maximum — всегда width_max.",
    "xlsx_auto_row_height": "Автоподбор высоты строк по содержимому. true | false.",
    "xlsx_freeze_pane_per_sheet": "Массив переопределений закрепления по листам: [ { \"sheet_index\": 0, \"cell\": \"B2\" }, { \"sheet_index\": 1, \"cell\": \"A2\" } ]. sheet_index — индекс листа (0, 1, …); cell — ячейка-граница. Для листа без записи используется freeze_cell.",
    "xlsx_autofilter": "Включить автофильтр по первой строке. true | false.",
    "xlsx_sheets_name": "Отображаемое имя листа в XLSX (до 31 символа). Варианты: 'Профили', 'Лист1', имя по файлу задаётся автоматически, если листов меньше чем файлов.",
    "xlsx_sheets_columns": "Список колонок для листа (пусто = все). Обычно [].",
    "xlsx_column_format": "Формат колонок на листе: объект { имя_колонки: { number_format, … } }. Применяется: number_format 'integer' — целое число. Если значение не преобразуется в указанный тип (например в колонке integer — текст), ячейка записывается по умолчанию (текст) и со стилем по умолчанию.",
    "xlsx_default_column_format": "Формат по умолчанию для всех колонок листа. Заголовок (первая строка): header_horizontal_align, header_vertical_align, header_fg_color, header_bg_color, header_bold, header_italic, header_underline. Данные (ячейки): data_horizontal_align, data_vertical_align, data_fg_color, data_bg_color, data_bold, data_italic, data_underline. Общие: number_format, width_min, width_max, wrap_text, float_decimals, decimal_separator, thousands_separator, date_format.",
    "column_formats_options": "Справочник опций форматирования. Применяются в XLSX: number_format (integer); width_min, width_max; выравнивание и стили заголовка (header_horizontal_align, header_vertical_align, header_fg_color, header_bg_color, header_bold, header_italic); выравнивание и стили данных (data_*); wrap_text при auto_row_height. Зарезервированы: float_decimals, date_format, header_underline, data_underline."
  },
  "input_dir": "IN",
  "output_dir": "OUT",
  "input_files": [
    "profiles_20260203-194146.json"
  ],
  "path_separator": " - ",
  "path_start": ["data", "body"],
  "exclude_keys": ["photoData", "reactions", "colorCode", "isSuperUser", "source"],
  "include_only_keys": [],
  "csv": {
    "encoding": "utf-8-sig",
    "delimiter": ";",
    "lineterminator": "\n"
  },
  "xlsx": {
    "freeze_first_row": true,
    "freeze_cell": "A2",
    "freeze_pane_per_sheet": [],
    "column_width_mode": "auto",
    "auto_row_height": false,
    "autofilter": true,
    "sheets": [
      {
        "name": "Профили",
        "columns": [],
        "default_column_format": {
        "number_format": "text",
        "width_min": 10,
        "width_max": 100,
        "wrap_text": true,
        "float_decimals": 2,
        "decimal_separator": ",",
        "thousands_separator": " ",
        "date_format": "DD.MM.YYYY",
        "header_horizontal_align": "left",
        "header_vertical_align": "center",
        "header_fg_color": "000000",
        "header_bg_color": "C6EFCE",
        "header_bold": true,
        "header_italic": false,
        "header_underline": false,
        "data_horizontal_align": "left",
        "data_vertical_align": "center",
        "data_fg_color": "000000",
        "data_bg_color": "",
        "data_bold": false,
        "data_italic": false,
        "data_underline": false
      },
        "column_format": {
          "gosbCode": { "number_format": "integer" },
          "groupingCode": { "number_format": "integer" },
          "clusterCode": { "number_format": "integer" },
          "reactionCount": { "number_format": "integer" },
          "tbCode": { "number_format": "integer" }
        }
      }
    ]
  },
  "column_formats": {
    "description": "Форматирование колонок: в default_column_format и column_format задаются параметры по имени колонки (или по умолчанию для листа). Применяются в XLSX: number_format, width_min/max, заголовок (header_*), wrap_text при auto_row_height.",
    "options": {
      "header_horizontal_align": "left|center|right — выравнивание заголовка по горизонтали (применяется)",
      "header_vertical_align": "top|center|bottom — выравнивание заголовка по вертикали (применяется)",
      "data_horizontal_align": "left|center|right — выравнивание данных по горизонтали (применяется)",
      "data_vertical_align": "top|center|bottom — выравнивание данных по вертикали (применяется)",
      "header_fg_color": "RRGGBB — цвет текста заголовка (применяется), пусто — по умолчанию",
      "header_bg_color": "RRGGBB — заливка заголовка (применяется), например C6EFCE — светло-салатовый",
      "data_fg_color": "RRGGBB — цвет текста в ячейках данных (применяется)",
      "data_bg_color": "RRGGBB — заливка ячеек данных, пусто — без заливки (применяется)",
      "header_bold": "true|false — жирный заголовок (применяется)",
      "header_italic": "true|false — курсив заголовка (применяется)",
      "header_underline": "true|false — подчёркивание заголовка (зарезервировано)",
      "data_bold": "true|false — жирный текст в данных (применяется)",
      "data_italic": "true|false — курсив в данных (применяется)",
      "data_underline": "true|false — подчёркивание в данных (зарезервировано)",
      "width_min": "минимальная ширина колонки; используется при column_width_mode auto|minimum (применяется)",
      "width_max": "максимальная ширина колонки; используется при column_width_mode auto|maximum (применяется)",
      "wrap_text": "true|false — перенос по словам; при auto_row_height влияет на расчёт высоты строк (применяется)",
      "number_format": "text|integer|float|date — тип данных; integer применяется в XLSX",
      "float_decimals": "число знаков после запятой (зарезервировано)",
      "decimal_separator": ",",
      "thousands_separator": " ",
      "date_format": "DD.MM.YYYY (зарезервировано)"
    }
  }
}
